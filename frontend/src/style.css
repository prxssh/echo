@import './styles/tokens.css';

html {
    background-color: var(--color-bg);
    color: var(--color-text);
}

/* Native dark UI elements when using Dark OLED */
:root[data-theme='dark-oled'] {
    color-scheme: dark;
}

/* Berkeley Mono embedding (optional). Place licensed WOFF2 files under
   src/assets/fonts/ with the following names. If not present, the app
   will fall back to system monospace fonts. */
@font-face {
    font-family: 'Berkeley Mono';
    src: url('assets/fonts/berkeley-mono-regular.woff2') format('woff2');
    font-style: normal;
    font-weight: 400;
    font-display: swap;
}

/* Inter (UI) embedding (optional). Place WOFF2 files under src/assets/fonts/
   The app will fall back to system UI fonts if not present. */
@font-face {
    font-family: 'Inter var';
    src:
        local('Inter var'),
        local('InterVariable'),
        url('assets/fonts/Inter-Variable.woff2') format('woff2');
    font-weight: 100 900;
    font-style: normal;
    font-display: swap;
}
@font-face {
    font-family: 'Inter';
    src:
        local('Inter Regular'),
        url('assets/fonts/Inter-Regular.woff2') format('woff2');
    font-weight: 400;
    font-style: normal;
    font-display: swap;
}
@font-face {
    font-family: 'Inter';
    src:
        local('Inter Bold'),
        url('assets/fonts/Inter-Bold.woff2') format('woff2');
    font-weight: 700;
    font-style: normal;
    font-display: swap;
}
@font-face {
    font-family: 'Berkeley Mono';
    src: url('assets/fonts/berkeley-mono-italic.woff2') format('woff2');
    font-style: italic;
    font-weight: 400;
    font-display: swap;
}
@font-face {
    font-family: 'Berkeley Mono';
    src: url('assets/fonts/berkeley-mono-bold.woff2') format('woff2');
    font-style: normal;
    font-weight: 700;
    font-display: swap;
}
@font-face {
    font-family: 'Berkeley Mono';
    src: url('assets/fonts/berkeley-mono-bold-italic.woff2') format('woff2');
    font-style: italic;
    font-weight: 700;
    font-display: swap;
}

body {
    margin: 0;
    color: var(--color-text);
    font-family: var(--font-ui);
    font-size: var(--font-size-md);
    line-height: var(--line-height);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* Ensure form controls inherit consistent typography */
:where(button, input, select, textarea) {
    font: inherit;
}

/* Typography utilities */
.text-2xs {
    font-size: var(--font-size-2xs);
}
.text-xs {
    font-size: var(--font-size-xs);
}
.text-sm {
    font-size: var(--font-size-sm);
}
.text-md {
    font-size: var(--font-size-md);
}
.text-lg {
    font-size: var(--font-size-lg);
}
.text-xl {
    font-size: var(--font-size-xl);
}
.text-2xl {
    font-size: var(--font-size-2xl);
}
.leading-normal {
    line-height: var(--line-height);
}
.font-mono {
    font-family: var(--font-mono);
}
.font-ui {
    font-family: var(--font-ui);
}

/* Responsive table helpers */
.table-wrap,
.tracker-table-wrap {
    width: 100%;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
}

.tracker-table-wrap table {
    min-width: 560px; /* Ensure columns remain visible; enables horizontal scroll on small screens */
}

.tracker-table {
    /* Use auto layout so widths adapt immediately */
    table-layout: auto;
}
.tracker-table th:first-child,
.tracker-table td:first-child {
    max-width: 60%;
    overflow: hidden;
    text-overflow: ellipsis;
}
.tracker-table td:nth-child(2),
.tracker-table td:nth-child(3),
.tracker-table td:nth-child(4),
.tracker-table td:nth-child(5),
.tracker-table th:nth-child(2),
.tracker-table th:nth-child(3),
.tracker-table th:nth-child(4),
.tracker-table th:nth-child(5) {
    text-align: right;
    white-space: nowrap;
}

/* Align first visible tracker column (Announce URL) under torrent Name by adding a spacer column */
/* Align the URL column under the torrent Name column by adding left padding
   equal to the remove icon column in the torrent list (36px) */
.tracker-table th:first-child,
.tracker-table td:first-child {
    padding-left: calc(var(--space-3) + 36px);
}

/* Grid-based tracker list for perfect header/body alignment */
.tracker-grid {
    display: grid;
    /* Use Torrent table measured column widths for perfect alignment */
    grid-template-columns:
        var(--tracker-col-1, var(--torrent-col-1, 36px))
        var(--tracker-col-2, var(--torrent-col-2, minmax(280px, 1fr)))
        var(--tracker-col-3, var(--torrent-col-3, 120px))
        var(--tracker-col-4, var(--torrent-col-4, 120px))
        var(--tracker-col-5, var(--torrent-col-5, 120px))
        var(--tracker-col-6, var(--torrent-col-6, 90px))
        var(--tracker-col-7, 120px);
    align-items: center;
    column-gap: 0; /* Keep columns flush like the table */
    min-width: 560px;
}
.table,
.tracker-grid {
    font-family: var(--font-ui);
    font-feature-settings:
        'kern' 1,
        'liga' 1;
}
.tracker-grid-header {
    font-weight: 600;
    opacity: 0.85;
    border-bottom: 1px solid var(--color-border);
    background: var(--color-surface);
}
/* Trackers header column separators */
.tracker-grid-header > div {
    position: relative;
}
/* Stronger, full-height visual separator using a pseudo element */
.tracker-grid-header > div + div::before {
    content: '';
    position: absolute;
    left: 0;
    top: 6px;
    bottom: 6px;
    width: 1px;
    background: var(--color-border);
    pointer-events: none;
}
/* Do not draw a separator before the Announce URL column (2nd cell) */
.tracker-grid-header > div:nth-child(2)::before {
    content: none;
}
.tracker-grid-header .num {
    text-align: left;
}
.tracker-grid-row {
    border-bottom: 1px solid var(--color-border-weak);
}
.tracker-grid-row:hover {
    background: var(--color-surface-strong);
}
.tracker-grid > div {
    /* Roomier rows for readability */
    padding: var(--space-3) var(--space-3);
}
/* Ensure Announce URL values start flush under the header text */
.tracker-grid-header > div:nth-child(2) {
    padding-left: var(
        --space-3
    ) !important; /* align header label with Name header */
}
.tracker-grid-row > div:nth-child(2) {
    padding-left: var(
        --space-3
    ) !important; /* mirror Torrent Name cell padding */
    grid-column: auto; /* use the dedicated URL column for alignment */
}
.tracker-grid .num {
    text-align: left;
    white-space: nowrap;
}

/* Peers list (grid, resizable) */
.peers-grid {
    display: grid;
    grid-template-columns:
        var(--peers-col-1, 48px)
        var(--peers-col-2, minmax(280px, 1fr))
        var(--peers-col-3, 200px);
    align-items: center;
    column-gap: 0;
    min-width: 560px;
}
.peers-grid-header {
    font-weight: 600;
    opacity: 0.85;
    border-bottom: 1px solid var(--color-border);
    background: var(--color-surface);
}
.peers-grid-header > div {
    position: relative;
}
.peers-grid-header > div + div::before {
    content: '';
    position: absolute;
    left: 0;
    top: 6px;
    bottom: 6px;
    width: 1px;
    background: var(--color-border);
    pointer-events: none;
}
.peers-grid-row {
    border-bottom: 1px solid var(--color-border-weak);
}
.peers-grid-row:hover {
    background: var(--color-surface-strong);
}
.peers-grid > div {
    padding: var(--space-3) var(--space-3);
}
.peers-grid .num {
    text-align: right;
    white-space: nowrap;
}

/* Visual ping when a peer message arrives */
@keyframes peerPulse {
    0% {
        background: var(--color-accent-weak);
    }
    100% {
        background: transparent;
    }
}
.peers-grid-row.peer-hot {
    animation: peerPulse 900ms ease-out 1;
}

@keyframes peerRemovePulse {
    0% {
        background: var(--color-danger-weak, rgba(255, 107, 107, 0.22));
    }
    50% {
        background: transparent;
    }
    100% {
        background: var(--color-danger-weak, rgba(255, 107, 107, 0.22));
    }
}
.peers-grid-row.peer-removing {
    animation: peerRemovePulse 1s ease-in-out 3;
}

@keyframes peerAddPulse {
    0% {
        background: var(--color-success-weak, rgba(80, 200, 120, 0.22));
    }
    100% {
        background: transparent;
    }
}
.peers-grid-row.peer-added {
    animation: peerAddPulse 900ms ease-out 1;
}

/* Ensure numeric headers align like table headers (left) */
.tracker-grid.tracker-grid-header .num {
    text-align: left;
}

.table {
    width: 100%;
    border-collapse: collapse;
}

.table th,
.table td {
    padding: 8px;
    border-bottom: 1px solid var(--color-border-weak);
}

@media (max-width: 720px) {
    .table th,
    .table td {
        padding: 6px;
        font-size: var(--font-size-sm);
    }
}
